<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Building Restful Services</title>
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <!-- Javascript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js" charset="utf-8"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    
    <!-- Components required for hyperagent (HAL client) - distributed through Bower -->
    <script src="bower_components/uri.js/src/URI.js"></script>
    <script src="bower_components/uri.js/src/URITemplate.js"></script>
    <script src="bower_components/q/q.js"></script>
    <script src="bower_components/hyperagent/dist/hyperagent.js"></script>
    
    
    <!-- Custom JS -->
    <script src="./client/main.js" charset="utf-8"></script>
    <script>
    $(document).ready(function() {
      let bugsIndex = 'http://m2.build-rest.net/hal-json/index.json';
      let container = $('#pipelines');
      
      let home = new Hyperagent.Resource(bugsIndex);

      home.fetch()
        .then(function(homeResource){
          let pipelines = { 'Backlog': homeResource.embedded.backlog, 
            'In Progress': homeResource.embedded.inProgress };

          container.append(_.map(pipelines, inline.renderPipeline).join(''));
        });
    });
    </script>

    <style media="screen">
      .row {
        min-height: 600px;
      }

      .bug-column {
        min-height: inherit;
        background-color: #F5F5F5;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-right:10px;
      }

      .list-group {
        margin-top: 20px;
        margin-bottom: 50px;
      }

      li {
        margin-top: 20px;
        border-radius: 4px;
      }

      a {
        cursor: pointer;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1><a href="./index.html">RESTbugs</a></h1>
      <div id="pipelines" class="row">
        <!-- pipelines -->
      </div>
    </div>
  </body>
</html>
